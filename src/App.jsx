import { useState, useEffect } from "react";
import Snowfall from "react-snowfall";
import GameCanvas from "./components/GameCanvas";
import "./style/app.scss";
import Loader from "./components/Loader";
import gameStore from "./store/gameStore";
import { observer } from "mobx-react-lite";
import Header from "./components/Header";

const App = observer(() => {
    const [showModal, setShowModal] = useState(false);

    useEffect(() => {
        const checkWidth = () => {
            const isSmallScreen = window.matchMedia("(max-width: 586px)").matches;
            setShowModal(isSmallScreen);
        };

        checkWidth();
        window.addEventListener("resize", checkWidth);

        return () => window.removeEventListener("resize", checkWidth);
    }, []);

    const handleCopy = () => {
        navigator.clipboard.writeText("https://xmas.mono.software")
    }

    return (
        <>
            <Header />
            <div className="content">
                {!gameStore.showGame && <Loader />}
                {gameStore.showGame && <GameCanvas />}
            </div>

            {showModal && (
                <div className="modal">
                    <div className="modal__content modal__content--transparent">
                        <svg xmlns="http://www.w3.org/2000/svg" width={100} height={100} viewBox="0 0 24 24" version="1.1" id="Phone-Rotate-2--Streamline-Ultimate.svg">
                            <path d="M17.292 0.04884C17.2392 0.075672 16.6128 0.564408 15.9 1.1349360000000002C14.79804 2.0169360000000003 14.595912 2.188248 14.55 2.279208C14.45016 2.476992 14.497104000000002 2.71404 14.667072000000001 2.870472C14.805312 2.99772 17.191488 4.90152 17.27424 4.950624C17.326704 4.981728 17.399016 4.997472 17.493576 4.99836C17.668944 5.0000160000000005 17.825736000000003 4.916688 17.922528 4.7704320000000004C17.977152 4.687896 17.988 4.645344000000001 17.988 4.513752C17.988 4.2474 17.988696 4.248168000000001 17.096016 3.5345039999999996C16.654608 3.181584 16.305408 2.888856 16.320072 2.883984C16.334712000000003 2.8790880000000003 16.510776 2.887632 16.711344 2.902944C18.47784 3.037824 20.12256 3.763608 21.350640000000002 4.950192C22.13484 5.7079200000000005 22.656048 6.52368 22.961592 7.471512C23.090568 7.8716159999999995 23.240328 8.006232 23.535528000000003 7.98744C23.723832 7.97544 23.862047999999998 7.887552 23.943504 7.728C24.028056 7.5623759999999995 24.017112 7.446288 23.878632 7.040039999999999C23.403888000000002 5.647392 22.4016 4.347456 21.103224 3.4403520000000003C19.781376 2.516904 18.2682 1.987704 16.66956 1.8897840000000001L16.575120000000002 1.8840000000000001 17.23356 1.356C17.952216 0.779712 18.000552000000003 0.726 17.999472 0.504912C17.99772 0.14241600000000001 17.605439999999998 -0.11049600000000001 17.292 0.04884M9.192 2.579736C8.902776000000001 2.644704 8.63976 2.763672 8.364 2.954256C8.139408 3.1094640000000004 2.99868 8.256072 2.8710240000000002 8.453472C2.6261520000000003 8.832168000000001 2.527536 9.182568000000002 2.551824 9.587568000000001C2.576568 10.00032 2.724264 10.384704000000001 2.994648 10.74C3.1986719999999997 11.008080000000001 13.187664 20.985816 13.38 21.113664C13.580088 21.246624 13.735248 21.321936 13.9446 21.387672000000002C14.17836 21.461064 14.659512 21.466872 14.904 21.39924C15.104904 21.343680000000003 15.408408000000001 21.201576 15.602856000000001 21.072048C15.76788 20.962128 20.807928 15.951432 21.024288 15.682176C21.175104 15.494520000000001 21.317472 15.22752 21.388056 15C21.43548 14.847144 21.443616000000002 14.771136000000002 21.441984 14.496C21.440304 14.209488 21.432336 14.148384 21.373248 13.968C21.294336 13.727160000000001 21.225312000000002 13.584264 21.077616000000003 13.356C20.993088 13.225368000000001 19.8474 12.065328 15.926471999999999 8.140392C12.853728 5.0645039999999995 10.810128 3.0366720000000003 10.694904 2.9491680000000002C10.331376 2.673096 10.046712 2.5680240000000003 9.624 2.553912C9.438048 2.54772 9.297096 2.556144 9.192 2.579736M9.322728 3.5842319999999996C8.993856000000001 3.692112 9.080952 3.6112800000000003 6.320952 6.370080000000001C3.8659200000000005 8.82408 3.72156 8.973023999999999 3.644952 9.131496C3.5721840000000005 9.282072 3.564 9.319944000000001 3.564 9.506376C3.564 9.702792 3.5694 9.724368 3.665976 9.91488C3.767904 10.115856 3.7713360000000002 10.119384 8.064 14.412L12.360024 18.707952000000002 15.534 15.534L18.707952000000002 12.360024 14.388696 8.040696C10.425984 4.077935999999999 10.0566 3.715056 9.913824 3.6447840000000005C9.732768 3.5556479999999997 9.486744 3.5304480000000003 9.322728 3.5842319999999996M16.23612 16.247880000000002L13.068287999999999 19.415784 13.498992 19.846968C14.028024 20.376648000000003 14.123856000000002 20.436 14.449800000000002 20.436C14.643984000000001 20.436 14.667743999999999 20.430072000000003 14.869800000000001 20.331408000000003L15.084 20.226792 17.678952000000002 17.631408C20.132112 15.177816 20.278344 15.026856 20.354952 14.868504C20.427576000000002 14.718432000000002 20.436 14.679744 20.436 14.496504C20.436 14.308104000000002 20.42868 14.27688 20.343072000000003 14.1C20.260104000000002 13.928591999999998 20.206152 13.8636 19.839959999999998 13.494C19.614384 13.266312000000001 19.423968 13.08 19.416864 13.08C19.409760000000002 13.08 17.9784 14.505552000000002 16.23612 16.247880000000002M0.31272 16.034712000000003C0.133392 16.10628 -0.000024 16.302096000000002 0.000024 16.493736000000002C0.000024 16.549992 0.03804 16.71324 0.084504 16.856568C0.551976 18.298296 1.5601680000000002 19.625832000000003 2.896776 20.559648000000003C4.218503999999999 21.483024 5.736432 22.01376 7.33164 22.110216L7.427304 22.116 6.79164 22.622664C6.442032 22.901352 6.13752 23.150136000000003 6.114912 23.175552C6.050688 23.247768 6 23.389128 6 23.496000000000002C6 23.855328 6.392064 24.108048 6.706416000000001 23.951352C6.76008 23.924616 7.3872 23.435856 8.1 22.865256000000002C9.20184 21.983184 9.404088 21.811752 9.450000000000001 21.720792C9.549840000000001 21.523032 9.50292 21.286056 9.332928 21.129432C9.196512 21.00372 6.809184 19.099248 6.72576 19.049568C6.673128000000001 19.018224 6.601296 19.002528 6.506424 19.001640000000002C6.331055999999999 18.999984 6.174264000000001 19.083312000000003 6.077472 19.229568C6.022848 19.312104 6.0120000000000005 19.354656 6.0120000000000005 19.486248C6.0120000000000005 19.752552 6.011448000000001 19.751952000000003 6.902400000000001 20.464248C7.342944 20.816448 7.698864 21.109152 7.69332 21.114672000000002C7.687776 21.120216 7.513152 21.112416 7.305264000000001 21.09732C5.530200000000001 20.968464 3.8616240000000004 20.231592 2.632464 19.033752C1.852776 18.273936 1.342584 17.472144 1.038408 16.528488C0.946392 16.243032 0.8722799999999999 16.133688 0.7172400000000001 16.054584000000002C0.618024 16.003968 0.414744 15.993984000000001 0.31272 16.034712000000003" stroke="none" fill="currentColor" fillRule="evenodd"></path>
                        </svg>
                        <h2>Please Rotate Your Device</h2>
                        <p>This game is best played in landscape mode.</p>
                        <p className="modal__info">
                            <div>If application doesn't let you rotate screen please visit link in another browser.</div>
                            <div className="modal__link"><span>https://xmas.mono.software</span><svg xmlns="http://www.w3.org/2000/svg" onClick={handleCopy} width={20} height={20} fill="none" viewBox="0 0 24 24"><path fill="white" fillRule="evenodd" d="M6.399 8.18a2 2 0 0 1 1.96 -1.596h12.73a2 2 0 0 1 2 2v12.73a2 2 0 0 1 -2 2H8.359a2 2 0 0 1 -2 -2V8.584c0 -0.139 0.013 -0.273 0.04 -0.404Zm3.405 6.769c0 0.414 0.335 0.75 0.75 0.75h3.42v3.421a0.75 0.75 0 0 0 1.5 0v-3.421h3.421a0.75 0.75 0 0 0 0 -1.5h-3.421v-3.421a0.75 0.75 0 1 0 -1.5 0v3.42h-3.42a0.75 0.75 0 0 0 -0.75 0.75ZM4.858 8.584v8.832H2.911a2 2 0 0 1 -2 -2V2.686a2 2 0 0 1 2 -2h12.73a2 2 0 0 1 2 2v2.397H8.359a3.5 3.5 0 0 0 -3.5 3.5Z" clipRule="evenodd" strokeWidth="1"></path></svg></div>
                        </p>

                    </div>
                </div>
            )}
            <Snowfall snowflakeCount={300} style={{ opacity: 0.5 }} />
        </>
    );
});

export default App;
